<h2>Welcome to Notes</h2>

<turbo-frame id="new_note_form">
  <%= render partial: "home/form", locals: { note: @note } %>
</turbo-frame>

<hr>
 
<h3>Your Notes</h3>
<turbo-frame id="notes_list">
  <%= render partial: "home/notes_list", locals: { notes: @notes } %>
</turbo-frame>
<turbo-frame id="modal"></turbo-frame>

<script>
  // Close modal when Turbo navigation finishes
  document.addEventListener("turbo:submit-end", () => {
    document.getElementById("modal").innerHTML = "";
  });
 document.addEventListener("turbo:load", () => {
    // On every page load, ensure modal is closed
    closeDeleteModal();
  });

  function openDeleteModal(noteId, title) {
    document.getElementById('deleteModal').style.display = 'flex';
    document.getElementById('deleteText').innerText = `Delete "${title}" ?`;
    const form = document.getElementById('deleteForm');
    form.action = `/notes/${noteId}`;
  }

  function closeDeleteModal() {
    document.getElementById('deleteModal').style.display = 'none';
  }
</script>

<!-- Delete confirmation modal -->
<div id="deleteModal" style="display:none; 
  position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.6); justify-content:center; align-items:center;">
  <div style="background:white; padding:20px; border-radius:10px; width:300px; text-align:center;">
    <h3>Confirm Delete</h3>
    <p id="deleteText"></p>
    <div style="margin-top:15px;">
     <form id="deleteForm" method="post" data-turbo="false">
  <input type="hidden" name="_method" value="delete">
  <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
  <button type="submit" style="background:red; color:white;">Yes, Delete</button>
  <button type="button" onclick="closeDeleteModal()">Cancel</button>
</form>


    </div>
  </div>
</div>
